# 二项分布二三事（一）

在古典概率模型中，概率总可以表示成大量重复实验的叠加结果。
二项分布针对实验结果为二元值时（比如发生与否、成功与否等）的统计量进行计算，是十分有用的统计工具。
本系列尝试使用尽量简单明了的方法，将它的内涵与外延记录下来。

---

[toc]

## 定义

假设 $ X \sim B(p, N) $，这指的是两个方面：

1. 在一次实验中，事件发生与否，且发生的概率为 $ p $。
2. 在 $ N $ 次独立实验中，事件发生了 $ x $ 次。

因此，$ X $ 的概率分布为：

$$
P(x) = C_N^x \cdot p^x \cdot q^{N-x}
$$

其中 $ p+q=1 $，且 $ C_N^x $ 表示从 $ N $ 中选择 $ x $ 个的组合数。

该组合数的计算方式为：

$$
C_N^x = \frac{N!}{x! \cdot (N-x)!}
$$

并且，$ P(x) $ 遵循完全的概率测度：

$$
\sum_{x=0}^{N} P(x) = (p+q)^N = 1
$$

$\blacksquare$

## 事例：连续投资的指数爆炸

假设有一个游戏，包含 $ N $ 次独立实验（投资），每次实验遵循二项分布规则：

- 如果事件发生（概率为 $ p $），则资产增长到原来的 $ a = 9 $ 倍；
- 如果事件未发生（概率为 $ q $），则资产减少到原来的 $ b = 0.1 $ 倍。

那么，最终资产的期望为：

$$
\sum_{x=0}^{N} P(x) \cdot a^x \cdot b^{N-x}
$$

事实上，这种投资与收益是几乎不可能长期维持的，因为指数增长得实在是太快了。假设事件连续发生$10$次，那么资产会膨胀到初始值的$9^{10}=3,486,784,401$倍（约为 34 亿倍）。
同样的，如果事件连续未发生这么多次，那么资产会缩水到原来的这么多分之一，可以认为几乎不存在了。

由于这个数值通常非常大（或者非常小），并且它的增长（缩水）速度也相当快，因此更好的方法是使用对数刻度来处理：

$$
\sum_{x=0}^{N} P(x) \cdot \log{\left( a^x \cdot b^{N-x} \right)}
$$

所谓对数就是将特别大（或者特别小）的数字转换成它是$10$的几次方，前面的例子中，$\log{9^{10}} \approx 9.5424$，以及$\log{0.1^{10}} = -10$。
也就是说，在对数尺度下的正数代表增长、负数代表缩小。且只有当数值发生倍数变化时，才会在对数尺度上产生明显变化。

但是这样的做法同样有问题，这几乎是一个常识的，“如何看待资产”的问题。如果一个人用`1万元`投资。那么当他的资产增长到`100万元`时，在对数坐标上得到的值是`2`；而当他的资产缩水到`100元`时，在对数坐标上得到的值是`-2`。
虽然二者在坐标轴上相加为零，但前者与后者带来的心理和社会收益却是完全无法相提并论的。
当然，除此之外，对数坐标还是比较适合显示连续相乘的结果。

我将以上算式的结果绘制如下，如图所示，
如果你按照这个规则进行投资，你会随着时间的推移失去所有的钱，因为在对数刻度下，在中心概率附近，收益的期望值是负数。

![exponentialBoom](/binomial-distribution-img/exponential%20boom.png "exponentialBoom")

### 分散投资策略

之前的分析结果表明，如果你将所有资金投入其中，长期来看你将失去所有的资金。
然而，如果你将资金分成 $ m $ 份，并分 $ m $ 次进行操作，情况会有所不同。
对于一次实验，其期望为：

$$
E(Y) = \frac{1}{m} \sum_{x=0}^{m} P_m(x) \left( a \cdot x + b \cdot (m - x) \right)
$$

其中 $ P_m(x) $ 是 $ m $ 次实验中 $ x $ 次成功的二项分布。
事实证明，如果你将资金分开进行实验，风险（用标准差衡量）会有所减少。标准差的计算方式为：

$$
\text{Var.} = E(Y^2) - E^2(Y)
$$

其中：

$$
E(Y^2) = \sum_{x=0}^{m} P_m(x) \left( \frac{a \cdot x + b \cdot (m - x)}{m} \right)^2
$$

![separating](/binomial-distribution-img/separating.png "separating")

## Gamma 函数

Gamma 函数（$ \Gamma $）的定义为：

$$
\Gamma(z) = \int_0^\infty t^{z-1} e^{-t} dt
$$

它具有一个重要的性质：

$$
\begin{cases}
\Gamma(z+1) &= z \Gamma(z) \\
\Gamma(0) &= 1
\end{cases}
\Rightarrow \Gamma(n+1) = n!, n \in [0, 1, 2, \dots]
$$

因此，$ P(x) $ 可以通过 Beta 函数来表示：

$$
\text{Beta}(x, y) = \frac{\Gamma(x+y+1)}{\Gamma(x+1) \Gamma(y+1)}
$$

并且，

$$
P_m(x) = \text{Beta}(x, m-x) \cdot p^x \cdot q^{m-x}
$$

$\blacksquare$
